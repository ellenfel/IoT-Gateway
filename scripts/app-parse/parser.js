const staticinputJson = `{
    "startFlag": 126,
    "type": 244,
    "length": 129,
    "version": 11,
    "timestamp": 1724140126,
    "mobileSignal": 29,
    "doutEnabled": [1, 1],
    "dout": [0, 0],
    "diMode": [1, 1, 1, 1],
    "din": [0, 0, 0, 0],
    "counter": [],
    "ainMode": [0, 0, 0, 0, 0, 0, 0, 0],
    "ain": [
        {"index": 1, "count": 0, "timeStep": 0, "values": []},
        {"index": 2, "count": 0, "timeStep": 0, "values": []},
        {"index": 3, "count": 0, "timeStep": 0, "values": []},
        {"index": 4, "count": 0, "timeStep": 0, "values": []},
        {"index": 5, "count": 0, "timeStep": 0, "values": []},
        {"index": 6, "count": 0, "timeStep": 0, "values": []},
        {"index": 7, "count": 0, "timeStep": 0, "values": []},
        {"index": 8, "count": 0, "timeStep": 0, "values": []}
    ],
    "sin": [
        {"index": 1, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 2, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 3, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 4, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 5, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 6, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 7, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 8, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 9, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[280]]},
        {"index": 10, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[280]]},
        {"index": 11, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[280]]},
        {"index": 12, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 13, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 14, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 15, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 16, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 17, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 18, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[280]]},
        {"index": 19, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[280]]},
        {"index": 20, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[280]]},
        {"index": 21, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 22, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 23, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 24, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 25, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 26, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 27, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]},
        {"index": 28, "length": 1, "timeStep": 0, "times": 1, "collectSuccess": true, "quantity": 1, "regType": "REG_HOLD_INT16", "sign": 0, "decimal": 0, "values": [[0]]}
    ],
    "endFlag": 126
}`;


//const inputJson = staticinputJson;





const inputJson = process.argv[2];

if (!inputJson) {
    console.error("Please provide a JSON string as an argument.");
    process.exit(1);
}

const input = JSON.parse(inputJson);

const output = {
    gpio_in_1: input.din[0] ? "on" : "off",
    gpio_in_2: input.din[1] ? "on" : "off",
    gpio_in_3: input.din[2] ? "on" : "off",
    gpio_in_4: input.din[3] ? "on" : "off",
    gpio_out_1: input.dout[0] ? "on" : "off",
    gpio_out_2: input.dout[1] ? "on" : "off",
    devName: "I-Link Box 3",
};

input.sin.forEach((sinItem) => {
    const channel = `modbus_chn_${sinItem.index}`;
    const value = sinItem.values[0][0];
    output[channel] = value / 100; // Assuming the value needs to be divided by 100 to get the correct format
});

console.log(JSON.stringify(output, null, 2));